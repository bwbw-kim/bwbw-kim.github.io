---
title: ğŸ‘– Spring ì—ì„œ ìì£¼ ì‚¬ìš©í•˜ëŠ” doFilter ì´í•´í•´ë³´ê¸°
date: 2023-05-22
categories: [Spring & JAVA]
tags: [spring, dofilter]
render_with_liquid: true
mermaid: true
---
#### spring ì—ì„œ filter ì™€ interceptor ëŠ” ë¬´ìŠ¨ ì°¨ì´ì¸ê°€ìš”?
---
Spring ì—ëŠ” dofilter ë¼ëŠ” ê²ƒì´ ì¡´ì¬í•œë‹¤. interceptor ì™€ ìœ ì‚¬í•˜ì§€ë§Œ ì•½ê°„ì˜ ì°¨ì´ì ì´ ìˆë‹¤.

```mermaid
graph LR
    Client --> dofilter --> dispatcherServlet --> interceptor --> controller
```
(dispatcherServlet ë¶€í„° Spring ë‚´ë¶€ë¼ê³  ìƒê°ì„ í•˜ë©´ ëœë‹¤.)

**í•„í„°**ëŠ” ìš°ì„ ! ë§ ê·¸ëŒ€ë¡œ ìš”ì²­ê³¼ ì‘ë‹µì„ ê±°ë¥´ëŠ” ì—­í• ì„ í•œë‹¤! spring ì— ë“¤ì–´ì˜¤ê¸° ì „ë¶€í„° ì‹¤í–‰ì´ ë  ìˆ˜ ìˆë‹¤!!

**interceptor** ëŠ” dispatcherServlet ì´ Controller ì— ìš”ì²­ì„ ë³´ë‚´ê¸° ì „ê³¼ í›„ì— ë¶ˆëŸ¬ì„œ ì‚¬ìš© í•  ìˆ˜ê°€ ìˆë‹¤
í‘œë¡œ ì •ë¦¬í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤!

|                   | Filter                                             | Interceptor                                               |
| ----------------- | -------------------------------------------------- | --------------------------------------------------------- |
| ê´€ë¦¬              | servlet container                                  | spring container                                          |
| req,res ì¡°ì‘ ê°€ëŠ¥ | O                                                  | X                                                         |
| ìš©ë„              | ì¸ì¦, ëª¨ë“ ê²ƒ ë¡œê¹…, springê³¼ ë¶„ë¦¬ë˜ì–´ì•¼ í•˜ëŠ” ê¸°ëŠ¥ë“¤ | Controller ë¡œ ë„˜ê²¨ ì£¼ë ¤ëŠ” ì •ë³´ ê°€ê³µ, API í˜¸ì¶œì— ëŒ€í•œ ë¡œê¹… |

#### dofilterInternal ì‚¬ìš©í•˜ê¸°
---

ì•„ë˜ ì²˜ëŸ¼ ê°„ë‹¨í•œ authCheck ë¥¼ ì§„í–‰í•˜ê³  ë°”ë¡œ spring ìœ¼ë¡œ ë“¤ì–´ì˜¤ê¸° ì „ì— error ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆë‹¤.
ì•„ë¬´ëŸ° ì—ëŸ¬ê°€ ì—†ë‹¤ë©´ `filterChain.doFilter(request, response);` ìœ¼ë¡œ ì›ë˜ í•˜ë ¤ë˜ ëŒ€ë¡œ dispatcherServlet ìœ¼ë¡œ ë³´ë‚´ì¤€ë‹¤

```java
public class CustomFilter extends OncePerRequestFilter  {
    @Override
    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)
            throws ServletException, IOException {
        try {
            if (!authCheck(request)) {
                response.sendError(HttpServletResponse.SC_UNAUTHORIZED, "Unauthorized");
                return;
            }
            filterChain.doFilter(request, response); // dispatcherServlet ë¡œ ë„˜ì–´ê°
        } catch (Exception e) {
            response.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR, "Internal Server Error");
            e.printStackTrace();
        }
    }
}
```