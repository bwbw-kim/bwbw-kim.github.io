---
title: ğŸ‘£ Actuator ìˆ¨ê¸°ê¸°
date: 2024-07-29
categories:
  - Spring & JAVA
tags:
  - actuator
  - prometheus
render_with_liquid: false
---
#### Actuator ìˆ¨ê¸°ê¸°
---
ì´ì „ì— Grafana, prometheus ì— ìš°ë¦¬ ì„œë¹„ìŠ¤ë¥¼ ì—°ê²°í•˜ê¸°ìœ„í•´ì„œ spring actuator package ë¥¼ ì¶”ê°€í•˜ê³  
`/actuator/prometheus`ì— ìš°ë¦¬ ì„œë¹„ìŠ¤ì˜ ì •ë³´ë¥¼ ë³´ì—¬ì¤„ìˆ˜ ìˆê²Œ í–ˆë‹¤. í•˜ì§€ë§Œ ì´ë°©ë²•ì€ ì‚¬ëŒë“¤ì´ ì € endpoint ë§Œ ì•Œê³ ìˆìœ¼ë©´ ìš°ë¦¬ ì„œë¹„ìŠ¤ì˜ ìƒíƒœë¥¼ ì•Œ ìˆ˜ê°€ ìˆë‹¤ëŠ” ëœ»ì´ì—ˆë‹¤. ë”°ë¼ì„œ í•´ë‹¹ ì •ë³´ë¥¼ ë³´ì—¬ì£¼ëŠ” port ë¥¼ ë‹¤ë¥´ê²Œ í•˜ê¸°ë¡œ í–ˆë‹¤.

#### ì„œë¹„ìŠ¤ í¬íŠ¸ì™€ ë‹¤ë¥¸ í¬íŠ¸ë¡œ ì—´ê¸°
application.properties ì— ë‹¤ìŒê³  ê°™ì€ config ë¥¼ ì¶”ê°€í•´ ì£¼ì—ˆë‹¤.
```properties
management.endpoints.enabled-by-default=false  # í™œì„±í™” ê¸°ë³¸ê°’ false  
management.endpoint.prometheus.enabled=true # í•„ìš”í•œ prometheus ë§Œ ì—°ë‹¤  
management.endpoints.web.exposure.include=prometheus  
manate.server.port=3000 # ìƒˆë¡œìš´ ì„ì˜ì˜ í¬íŠ¸
```

ì´ë ‡ê²Œ ì„¤ì •ì„ í•˜ë©´ `{ip}:{3000}/actuator/prometheus` ë¡œ ì‹œìŠ¤í…œì˜ ì •ë³´ë¥¼ ë³¼ ìˆ˜ ìˆëŠ” Endpoint ë¥¼ ì˜®ê¸¸ìˆ˜ìˆë‹¤.

#### k8sì—ì„œ helm ì°¨íŠ¸ì— ì¶”ê°€ë¡œ í•´ì¤˜ì•¼í•˜ëŠ” ì„¤ì •
k8s ìƒì—ì„œ ìš°ë¦¬ ì„œë¹„ìŠ¤ê°€ ë– ìˆê¸° ë•Œë¬¸ì— ì¶”ê°€ë¡œ helm ì°¨íŠ¸ì— ì ì–´ì£¼ì–´ì•¼ í• ê²ƒì´ ìˆë‹¤. ìš°ì„  prometheus ê°€ service.yaml ê¸°ë°˜ìœ¼ë¡œ metric ì„ ê°€ì ¸ì˜¤ê¸° ë•Œë¬¸ì— service.yaml ì˜ spec.ports ë¥¼ ì¡°ê¸ˆ ì¶”ê°€í•´ì¤€ë‹¤

```yaml 
spec:  
Â  ports:  
Â Â Â  - name : metrics  
Â Â Â Â Â  port: 3000  
Â Â Â Â Â  protocol: TCP  
Â Â Â Â Â  targetPort: 3000
```

ê·¸ë¦¬ê³  networkpolicy,yaml ì„ ì‚¬ìš©í•˜ê³ ìˆë‹¤ë©´ ì—­ì‹œ 3000 í¬íŠ¸ë¥¼ ë„£ì–´ì¤€ë‹¤.

```yaml
spec:  
Â  ingress:  
Â Â Â  ports:  
Â Â Â Â Â  - port :3000  
Â Â Â Â Â Â Â  protocal : TCP
```

ì˜ ìˆ˜ì§‘ì´ ëœë‹¤!